[platformio]
src_dir = src/

[env]
platform = teensy
board = teensy40
framework = arduino
upload_protocol = teensy-cli
build_src_filter = # Let's be more specific and choose our files specifically.
    -<*>

# List of available build-flags!
# https://docs.platformio.org/en/latest/platforms/teensy.html#usb-features

[env:lbs-debug]
build_type = debug
# See https://github.com/platformio/platform-teensy/issues/65
build_unflags = -DUSB_SERIAL

lib_deps =
    https://github.com/ftrias/TeensyDebug/archive/refs/heads/master.zip

build_flags =
    ${env.build_flags}
    -D USB_DUAL_SERIAL
    -O0

build_src_filter =
    +<main.cpp>

# Specify a serial port for communication support with gdb
debug_port = /dev/ttyACM0
debug_tool = custom
debug_load_mode = manual
debug_server =
debug_init_cmds =
    target extended-remote $DEBUG_PORT
    $INIT_BREAK
    define pio_reset_run_target
    interrupt
    tbreak loop
    continue
    end
    define pio_restart_target
    echo Restart is undefined for now.
    end

debug_init_break =
